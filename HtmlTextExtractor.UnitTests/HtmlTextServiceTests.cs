namespace HtmlTextExtractor.UnitTests;

internal static class TestUtils
{
    internal static List<string> GetLines(string sourceString)
    {
        return sourceString
            .Trim()
            .Split("\r\n", StringSplitOptions.RemoveEmptyEntries)
            .Where(line => !string.IsNullOrWhiteSpace(line))
            .Select(line => line.Trim())
            .ToList();
    }
}

public class Tests
{
    [TestCase("", "")]
    [TestCase("\r\n", "")]
    [TestCase("<br>", "\r\n")]
    [TestCase("a<br>b", "a\r\nb")]
    [TestCase("      a     \r\n       b       \r\n c", "a b c")]
    [TestCase("      a     \r\n<br>       b    <br>       \r\n c", "a\r\nb\r\nc")]

    // test mail layout:
    [TestCase(@"<div dir=""ltr"">
    ShipperFirstLast: TestLeadHtml 123123
    <br>City State Country: City_1, New York, United States
    <br>phone: 123
    <br>homephone: 222
    <br>Street1: street 2
    <br>Consignee Last First: LastName123123 FirstName123123
    <br>ConsigneeMobilePhone: 888
    <br>Description: Description
    <br>City Country: City_3, Canada
    <br>Email: <a href=""mailto:aoaoao@aoaoa.aoao"" target=""_blank"">aoaoao@aoaoa.aoao</a>
</div>",
        @"ShipperFirstLast: TestLeadHtml 123123
City State Country: City_1, New York, United States
phone: 123
homephone: 222
Street1: street 2
Consignee Last First: LastName123123 FirstName123123
ConsigneeMobilePhone: 888
Description: Description
City Country: City_3, Canada
Email: aoaoao@aoaoa.aoao")]

    // prod mail layout:
    [TestCase(
        @"<div style=""font-family: arial; font-size: 14px;""><div fr-original-style="""" style=""box-sizing: border-box;""><br fr-original-style="""" style=""box-sizing: border-box;""></div><div fr-original-style="""" style=""box-sizing: border-box;""><br fr-original-style="""" style=""box-sizing: border-box;""></div><div contenteditable=""false"" fr-original-style="""" style=""box-sizing: border-box;""><span fr-original-style="""" style=""box-sizing: border-box;"">&nbsp;</span></div><div fr-original-style="""" style=""box-sizing: border-box;""><br fr-original-style="""" style=""box-sizing: border-box;""></div><hr id=""previousmessagehr"" fr-original-style="""" style=""box-sizing: border-box; clear: both; user-select: none;""><div fr-original-style="""" style=""box-sizing: border-box;""><span fr-original-style="""" style=""box-sizing: border-box;""><strong fr-original-style="""" style=""box-sizing: border-box; font-weight: 700;"">From</strong>: ""BgCorpLocal"" &lt;leads@BgCorpLocal.org&gt;<br fr-original-style="""" style=""box-sizing: border-box;""><strong fr-original-style="""" style=""box-sizing: border-box; font-weight: 700;"">Sent</strong>: 12/11/21 5:31 PM<br fr-original-style="""" style=""box-sizing: border-box;""><strong fr-original-style="""" style=""box-sizing: border-box; font-weight: 700;"">To</strong>: BgCorpLocalleads@somecorp.com<br fr-original-style="""" style=""box-sizing: border-box;""><strong fr-original-style="""" style=""box-sizing: border-box; font-weight: 700;"">Subject</strong>: New Quote Request (Move) - #4371</span></div><div fr-original-style="""" style=""box-sizing: border-box;""><br fr-original-style="""" style=""box-sizing: border-box;""></div><div fr-original-style="""" style=""box-sizing: border-box;"">New Quote Request (Move) - #4371</div><!--[endif]----><table align="""" cellpadding=""0"" cellspacing=""0"" fr-original-style=""padding:0;margin-top:0;margin-bottom:0;max-width:640px;font-family:Arial;font-size:16px;margin-left:auto;margin-right:auto;width:640px;"" style=""padding: 0px; margin: 0px auto; max-width: 640px; font-family: Arial; font-size: 16px; width: 640px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><br fr-original-style="""" style=""box-sizing: border-box;""><table border=""0"" cellspacing=""0"" fr-original-style=""background-color:#fff;padding:30px;"" style=""background-color: rgb(255, 255, 255); padding: 30px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""640px""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><table border=""0"" cellspacing=""0"" fr-original-style=""max-width:640px;"" style=""max-width: 640px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""640px""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style=""padding:2px 0;"" style=""padding: 2px 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"" width=""89""><img src=""https://public.BgCorpLocal.info/mail/logo2.png"" alt=""Logo"" fr-original-style="""" fr-original-class=""fr-draggable"" style=""box-sizing: border-box; position: relative; max-width: 100%; cursor: pointer; padding: 0px 1px;""></td><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h1 fr-original-style=""font-size:28px;color:#2B3C4D;margin:0;"" style=""font-size: 28px; color: rgb(43, 60, 77); margin: 0px; box-sizing: border-box;"">BgCorpLocal</h1></td></tr></tbody></table><img src=""https://public.BgCorpLocal.info/mail/header-image.jpg"" style=""width: 100%; max-width: 580px; box-sizing: border-box; position: relative; cursor: pointer; padding: 0px 1px;"" width=""570"" fr-original-style=""width: 100%; max-width: 580px;"" fr-original-class=""fr-draggable""><h1 fr-original-style=""font-weight: normal; margin: 20px 0; color: #2B3C4D; font-size: 26px; mso-line-height-rule:exactly;"" style=""font-weight: normal; margin: 20px 0px; color: rgb(43, 60, 77); font-size: 26px; box-sizing: border-box;"">New Quote Request (Move) - #4371</h1><table border=""0"" cellspacing=""0"" fr-original-style=""font-size:15px;"" style=""font-size: 15px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""640px""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Moving details</h2></td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Request type:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Move</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Moving size:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Removal â€“ Household (Partial)</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Moving date:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">2022-02-15</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Volume (m<sup fr-original-style="""" style=""box-sizing: border-box;"">3</sup>):</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">0.0</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Volume (ft<sup fr-original-style="""" style=""box-sizing: border-box;"">3</sup>):</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">0.0</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Storage:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Packing:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Assembly:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Business:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">No</td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Moving from</h2></td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Street:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">39-25 21 Street</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Zipcode:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">11101</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">City:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">New York</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Country:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">United States</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Region:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">NY - New York, 111 - Long Island City</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Type of residence:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Google Maps:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><a fr-original-style=""font-size:16px;margin:0 0 0;padding:0;color:inherit;"" href=""https://click.pstmrk.it/2sm/maps.google.com%2F%3Fq%3D39-25%2B21%2BStreet%252C11101%252CNew%2BYork/U0ScpCcN/nSkn/p182rh2Iur/Y3VzdG9tZXJfcmVxdWVzdA"" style=""font-size: 16px; margin: 0px; padding: 0px; color: inherit; box-sizing: border-box; text-decoration: underline; user-select: auto;"" target=""_blank"" rel=""noopener noreferrer"">View</a></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Moving to</h2></td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Street:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Zipcode:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">City:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Paris</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Country:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">France</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Region:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">75 - Paris</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Type of residence:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Google Maps:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><a fr-original-style=""font-size:16px;margin:0 0 0;padding:0;color:inherit;"" href=""https://click.pstmrk.it/2sm/maps.google.com%2F%3Fq%3DParis/VEScpCcN/nSkn/cNBaCCByUo/Y3VzdG9tZXJfcmVxdWVzdA"" style=""font-size: 16px; margin: 0px; padding: 0px; color: inherit; box-sizing: border-box; text-decoration: underline; user-select: auto;"" target=""_blank"" rel=""noopener noreferrer"">View</a></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Contact details</h2></td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Company name:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Name:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Max Katz</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Telephone #1:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">+88005553535</td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Telephone #2:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">-</td></tr><tr fr-original-style=""background-color:#F4F5F5;"" style=""background-color: rgb(244, 245, 245); box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Email:</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><a fr-original-style=""font-size:16px;margin:0 0 0;padding:0;color:inherit;"" href=""mailto:foobarbz@hooray.com"" style=""font-size: 16px; margin: 0px; padding: 0px; color: inherit; box-sizing: border-box; text-decoration: underline; user-select: auto;"" target=""_blank"" rel=""noopener noreferrer"">foobarbz@hooray.com</a></td></tr><tr fr-original-style=""background-color:transparent;"" style=""background-color: transparent; box-sizing: border-box; user-select: none;""><td fr-original-style=""color:#535b65;padding:0;"" style=""color: rgb(83, 91, 101); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">Language (of form):</td><td fr-original-style=""color:#40454c;padding:0;"" style=""color: rgb(64, 69, 76); padding: 0px; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;"">English</td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Remarks</h2></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style=""word-break:break-all;"" style=""word-break: break-all; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><p fr-original-style=""font-size:15px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:0;"" style=""font-size: 15px; margin: 0px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">1 sofa, 1 dining table, 2 shelves, 10 boxes of household goods</p></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><h2 fr-original-style=""font-size:18px;color:#292D31;font-weight:bold;margin:15px 0 10px;mso-line-height-rule:exactly;"" style=""font-size: 18px; color: rgb(41, 45, 49); font-weight: bold; margin: 15px 0px 10px; box-sizing: border-box;"">Remarks (Translation)</h2></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style=""word-break:break-all;"" style=""word-break: break-all; box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><p fr-original-style=""font-size:14px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:8px;"" style=""font-size: 14px; margin: 0px 0px 8px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">1 sofa, 1 dining table, 2 shelves, 10 boxes of household goods</p></td></tr><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td colspan=""2"" fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><small fr-original-style="""" style=""box-sizing: border-box;""><em fr-original-style="""" style=""box-sizing: border-box;"">As an additional service, the remarks are translated to your preferred language by Google Translate. No rights can be derived from this translation.</em></small></td></tr></tbody></table><br fr-original-style="""" style=""box-sizing: border-box;""></td></tr></tbody></table><br fr-original-style="""" style=""box-sizing: border-box;""><table fr-original-style=""background-color: #fff; padding: 30px; width: 100%;"" style=""background-color: rgb(255, 255, 255); padding: 30px; width: 100%; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><p fr-original-style=""font-size:14px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:15px;"" style=""font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">We have promised our customer you would contact him/her within 2 working days. Good luck with this request.</p><p fr-original-style=""font-size:14px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:15px;"" style=""font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">Kind regards,</p><p fr-original-style=""font-size:14px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:15px;"" style=""font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">BgCorpLocal</p><p fr-original-style=""font-size:14px;margin:0 0 18px 0;padding:0;color:#535b65;margin-bottom:0;"" style=""font-size: 14px; margin: 0px; padding: 0px; color: rgb(83, 91, 101); box-sizing: border-box;"">P.S.: This request is sent to 4 other movers.</p></td></tr></tbody></table><br fr-original-style="""" style=""box-sizing: border-box;""><table align=""center"" cellpadding=""0"" cellspacing=""0"" fr-original-style=""padding:0;margin-top:0;margin-bottom:0;max-width:640px;font-family:Arial;font-size:16px;margin-left:0;margin-right:0;"" style=""padding: 0px; margin: 0px; max-width: 640px; font-family: Arial; font-size: 16px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""640px""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><p fr-original-style=""font-size:12px;margin:0 0 18px 0;padding:0;color:#535b65;text-align:right;margin-bottom:0;"" style=""font-size: 12px; margin: 0px; padding: 0px; color: rgb(83, 91, 101); text-align: right; box-sizing: border-box;"">Our <a fr-original-style="""" href=""https://click.pstmrk.it/2sm/www.BgCorpLocal.org%2Fgeneral-terms-and-conditions%2F/VUScpCcN/nSkn/jVugnCp0NX/Y3VzdG9tZXJfcmVxdWVzdA"" style=""box-sizing: border-box; color: rgb(0, 102, 147); text-decoration: underline; user-select: auto;"" target=""_blank"" rel=""noopener noreferrer"">General Terms and Conditions</a> apply to this and all other services of BgCorpLocal.</p></td></tr></tbody></table><table align=""center"" cellpadding=""0"" cellspacing=""0"" fr-original-style=""padding:0;margin-top:0;margin-bottom:0;max-width:640px;font-family:Arial;font-size:16px;margin-left:0;margin-right:0;"" style=""padding: 0px; margin: 0px; max-width: 640px; font-family: Arial; font-size: 16px; box-sizing: border-box; border: none; border-collapse: collapse; empty-cells: show;"" width=""640px""><tbody fr-original-style="""" style=""box-sizing: border-box;""><tr fr-original-style="""" style=""box-sizing: border-box; user-select: none;""><td fr-original-style="""" style=""box-sizing: border-box; min-width: 5px; border: 1px solid rgb(221, 221, 221); user-select: text;""><p fr-original-style=""font-size:12px;margin:0 0 18px 0;padding:0;color:#535b65;text-align:right;margin-bottom:0;"" style=""font-size: 12px; margin: 0px; padding: 0px; color: rgb(83, 91, 101); text-align: right; box-sizing: border-box;"">Â© 2004 - 2021 BgCorpLocal B.V.</p></td></tr></tbody></table></td></tr></tbody></table><div fr-original-style="""" style=""box-sizing: border-box;""><img src=""https://ea.pstmrk.it/open/v3_6WGKzd0tg8MtQMTH9jMCwBHqbXvR-HG8nS1g6cX3GZDpmzxXtCUXAuisvZl-WL5o3AX7rzWnoCTgFBWMGj24htdH1hBj09q90e468tOmQdshACv8SMDXMg5uGEeduB3LSejqcf8B9G_vrVv9rvNSvNdYuX-Whkmzs7a0Xy1UTAu88ODC2BmW36D7F_-H5sZocr2JR6A752MmFnB_4Mmd4w50mJ3xgp2pX0_pBXpJtOxkY4nT3-RTqDJXIpkp2pTloZHCfsBxr2LZOpuIfFc4y5_OdgXwIHX-DWClzwl3T7ie4iWWOjigKeO2t0nUJmIRch5DceOe0aJhtsqUWRAz2ZpfNTf3J-GcUvOdUUfgc61VZ6FTA6XCE4p7maSXVf1reb8l936TqIucoUNq_10KRuewIMakrVZyE4lq294PwI2x0FD7t2z9KYSU5XkMWb_U"" width=""1"" height=""1"" border=""0"" alt="""" fr-original-style="""" fr-original-class=""fr-draggable"" style=""box-sizing: border-box; position: relative; max-width: 100%; cursor: pointer; padding: 0px 1px;""></div></div>",
        @"



From: ""BgCorpLocal"" <leads@BgCorpLocal.org>
Sent: 12/11/21 5:31 PM
To: BgCorpLocalleads@somecorp.com
Subject: New Quote Request (Move) - #4371

New Quote Request (Move) - #4371

BgCorpLocal
 New Quote Request (Move) - #4371
 Moving details
 Request type:Move
 Moving size:Removal â€“ Household (Partial)
 Moving date:2022-02-15
 Volume (m3):0.0
 Volume (ft3):0.0
 Storage:-
 Packing:-
 Assembly:-
 Business:No
 Moving from
 Street:39-25 21 Street
 Zipcode:11101
 City:New York
 Country:United States
 Region:NY - New York, 111 - Long Island City
 Type of residence:-
 Google Maps:View
 Moving to
 Street:-
 Zipcode:-
 City:Paris
 Country:France
 Region:75 - Paris
 Type of residence:-
 Google Maps:View
 Contact details
 Company name:-
 Name:Max Katz
 Telephone #1:+88005553535
 Telephone #2:-
 Email:foobarbz@hooray.com
 Language (of form):English
 Remarks
 1 sofa, 1 dining table, 2 shelves, 10 boxes of household goods

 Remarks (Translation)
 1 sofa, 1 dining table, 2 shelves, 10 boxes of household goods

 As an additional service, the remarks are translated to your preferred language by Google Translate. No rights can be derived from this translation.


We have promised our customer you would contact him/her within 2 working days. Good luck with this request.

 Kind regards,

 BgCorpLocal

 P.S.: This request is sent to 4 other movers.


Our General Terms and Conditions apply to this and all other services of BgCorpLocal.

 Â© 2004 - 2021 BgCorpLocal B.V.

 ")]
    public async Task TestConvertToPlainTextAsync(string sourceHtml, string expectedTextResult)
    {
        // get a plain text version
        var actualTextResult = HtmlTextService.MakePlainBodyFromHtmlBody(sourceHtml);

        // compare
        var expectedLines = TestUtils.GetLines(expectedTextResult);
        var actualLines = TestUtils.GetLines(actualTextResult);

        Assert.That(actualLines, Has.Count.EqualTo(expectedLines.Count));

        var zip = expectedLines.Zip(actualLines);

        foreach (var (expectedLine, actualLine) in zip)
        {
            Assert.That(actualLine, Is.EqualTo(expectedLine));
        }
    }
}
